<?xml version="1.0" encoding="utf-8" ?>
<queries>
  <query key="CheckLoginDetails">SELECT * FROM LIBRARY_ADMIN WHERE USER_ID=@USER_ID AND PASSWORD = @PASSWORD</query>
  
  <query key="GetAllStudents">SELECT * FROM LIBRARY_STUDENT</query>
  <query key="InsertStudent">INSERT INTO LIBRARY_STUDENT (ID_NUMBER, FIRST_NAME, LAST_NAME, EMAIL, ADDRESS, TELEPHONE, REGISTERED_DATE, TERMINATED_DATE) VALUES (@ID_NUMBER, @FIRST_NAME, @LAST_NAME, @EMAIL, @ADDRESS, @TELEPHONE, @REGISTERED_DATE, @TERMINATED_DATE)</query>
  <query key="CheckDuplicateId">SELECT COUNT(*) FROM LIBRARY_STUDENT WHERE ID_NUMBER = @ID_NUMBER</query>
  <query key="CheckDuplicateEmail">SELECT COUNT(*) FROM LIBRARY_STUDENT WHERE EMAIL = @EMAIL</query>
  <query key="GetStudentById">SELECT * FROM LIBRARY_STUDENT WHERE STUDENT_ID=@id</query>
  <query key="UpdateStudent">UPDATE LIBRARY_STUDENT SET ID_NUMBER = @ID_NUMBER, FIRST_NAME = @FIRST_NAME, LAST_NAME = @LAST_NAME, EMAIL = @EMAIL, ADDRESS = @ADDRESS, TELEPHONE = @TELEPHONE, REGISTERED_DATE = @REGISTERED_DATE, TERMINATED_DATE = @TERMINATED_DATE WHERE STUDENT_ID = @id</query>
  <query key="DeleteStudent">DELETE FROM LIBRARY_STUDENT WHERE STUDENT_ID=@id</query>

  <query key="SelectAllBooks">SELECT * FROM LIBRARY_BOOK</query>
  <query key="InsertBook">INSERT INTO LIBRARY_BOOK (BOOK_REFERENCE_NUMBER, TITLE, ISBN, AUTHOR, PUBLICATION, EDITION, PUBLISHED_YEAR, CATEGORY, NO_OF_COPY, AVAILBLE_COPY) VALUES (@BOOK_REFERENCE_NUMBER, @TITLE, @ISBN, @AUTHOR, @PUBLICATION, @EDITION, @PUBLISHED_YEAR, @CATEGORY, @NO_OF_COPY, @AVAILBLE_COPY)</query>
  <query key="CheckDuplicate">SELECT COUNT(*) FROM LIBRARY_BOOK WHERE BOOK_REFERENCE_NUMBER = @BOOK_REFERENCE_NUMBER OR ISBN = @ISBN</query>
  <query key="SelectBookById">SELECT * FROM LIBRARY_BOOK WHERE BOOK_ID = @id</query>
  <query key="UpdateBook">UPDATE LIBRARY_BOOK SET BOOK_REFERENCE_NUMBER = @BOOK_REFERENCE_NUMBER, TITLE = @TITLE, ISBN = @ISBN, AUTHOR = @AUTHOR, PUBLICATION = @PUBLICATION, EDITION = @EDITION, PUBLISHED_YEAR = @PUBLISHED_YEAR, CATEGORY = @CATEGORY, NO_OF_COPY = @NO_OF_COPY WHERE BOOK_ID = @id</query>
  <query key="DeleteBook">DELETE FROM LIBRARY_BOOK WHERE BOOK_ID = @id</query>

  <query key="SelectAllCDs">SELECT * FROM LIBRARY_CD</query>
  <query key="InsertCD">INSERT INTO LIBRARY_CD (CD_TITLE,AUTHOR,PUBLICATION,PRINTED_YEAR,CATEGORY) VALUES (@CD_TITLE,@AUTHOR,@PUBLICATION,@PRINTED_YEAR,@CATEGORY)</query>
  <query key="CheckDuplicateCD">SELECT COUNT(*) FROM LIBRARY_CD WHERE CD_TITLE = @CD_TITLE</query>
  <query key="SelectCDById">SELECT * FROM LIBRARY_CD WHERE CD_ID = @id</query>
  <query key="UpdateCD">UPDATE LIBRARY_CD SET CD_TITLE=@CD_TITLE, AUTHOR=@AUTHOR, PUBLICATION=@PUBLICATION, PRINTED_YEAR=@PRINTED_YEAR, CATEGORY=@CATEGORY WHERE CD_ID = @id</query>
  <query key="DeleteCD">DELETE FROM LIBRARY_CD WHERE CD_ID = @id</query>

  <query key="SelectAllIssueBooks">
    <![CDATA[
        SELECT * FROM LIBRARY_ISSUE_BOOKS
        ]]>
  </query>
  <query key="InsertIssueBook">
    <![CDATA[
        INSERT INTO LIBRARY_ISSUE_BOOKS (BOOK_ID, STUDENT_ID, ISSUE_DATE, RETURN_DATE) 
        VALUES (@BOOK_ID, @STUDENT_ID, @ISSUE_DATE, @RETURN_DATE)
        ]]>
  </query>
  <query key="UpdateBookAvailableCopy">
    <![CDATA[
        UPDATE LIBRARY_BOOK 
        SET AVAILBLE_COPY = AVAILBLE_COPY - 1 
        WHERE BOOK_ID = @BOOK_ID AND AVAILBLE_COPY > 0
        ]]>
  </query>
  <query key="SelectIssueBookById">
    <![CDATA[
        SELECT * FROM LIBRARY_ISSUE_BOOKS WHERE ISSUE_ID = @IssueId
        ]]>
  </query>
  <query key="UpdateIssueBook">
    <![CDATA[
        UPDATE LIBRARY_ISSUE_BOOKS 
        SET BOOK_ID = @BOOK_ID, STUDENT_ID = @STUDENT_ID, ISSUE_DATE = @ISSUE_DATE, RETURN_DATE = @RETURN_DATE 
        WHERE ISSUE_ID = @id
        ]]>
  </query>
  <query key="SelectActiveStudents">
    <![CDATA[
        SELECT STUDENT_ID, CONCAT(FIRST_NAME, ' ', LAST_NAME) AS STUDENT_NAME 
        FROM LIBRARY_STUDENT 
        WHERE TERMINATED_DATE IS NULL
        ]]>
  </query>
  <query key="SelectAvailableBooks">
    <![CDATA[
        SELECT BOOK_ID, TITLE 
        FROM LIBRARY_BOOK 
        WHERE AVAILBLE_COPY > 0
        ]]>
  </query>
</queries>
